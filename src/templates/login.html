{% extends "base.html" %}
{% load static %}

{% block title %}Đăng nhập - Tra cứu hoá đơn 24/7{% endblock %}

{% block content %}
  <div class="flex min-h-screen items-center justify-center px-5 py-8 gradient-bg">
    <div class="bg-white w-full max-w-[420px] rounded-2xl px-8 pt-9 pb-10 shadow-[0_20px_40px_rgba(0,0,0,0.08)] max-sm:px-5 max-sm:pt-7 max-sm:pb-8">
      <div class="text-3xl font-semibold">Đăng nhập</div>
      <div class="text-sm text-slate-500 mt-2">Đăng nhập để truy cập trang quản lý</div>

      <form method="post" class="mt-7" x-data="login_data()" x-cloak @submit="submitting = true">
        {% csrf_token %}
        {% include "components/form/input.html" with name="username" label="Tên đăng nhập" value=form.username.value placeholder="Nhập tên đăng nhập" required=True %}
        {% include "components/form/input.html" with name="password" label="Mật khẩu" placeholder="Nhập mật khẩu" type="password" required=True wrapper_class="mt-3" %}

        <div class="w-full flex flex-col gap-1 mt-2">
          {% for error in form.non_field_errors %}
            {% include "components/alert.html" with tag="error" message=error %}
          {% endfor %}
        </div>

        {% include "components/form/text_button.html" with type="submit" has_spinner=True loading_key="submitting" text="Đăng nhập" class="w-full mt-6" %}

        <div class="text-center mt-4">
          <a href="/" class="text-sm text-blue-500 hover:text-blue-600">← Truy cập trang tra cứu</a>
        </div>

        <script>
          function login_data() {
            return {
              submitting: false,
              init() {
                this.$nextTick(() => {
                  const usernameInput = this.$el.querySelector('input[name="username"]');
                  usernameInput.focus();
                  usernameInput.setSelectionRange(usernameInput.value.length, usernameInput.value.length);
                });
              }
            }
          }
        </script>
      </form>
    </div>
  </div>
{% endblock %}
